{% extends "base.html" %}

{% block title %}Мои заказы - Food Delivery{% endblock %}

{% block content %}
<div class="row mb-4">
    <div class="col-12">
        <h1>Мои заказы</h1>
        <p class="lead">История ваших заказов</p>
    </div>
</div>

{% if orders.items %}
<div class="table-responsive">
    <table class="table table-hover">
        <thead class="table-dark">
            <tr>
                <th>№ Заказа</th>
                <th>Дата</th>
                <th>Адрес</th>
                <th>Сумма</th>
                <th>Статус</th>
                <th>Действия</th>
            </tr>
        </thead>
        <tbody>
            {% for order in orders.items %}
            <tr>
                <td>#{{ order.id }}</td>
                <td>{{ order.created_at.strftime('%d.%m.%Y %H:%M') }}</td>
                <td>{{ order.address[:50] }}{% if order.address|length > 50 %}...{% endif %}</td>
                <td>{{ order.total }} ₽</td>
                <td>
                    {% if order.status == 'Новый' %}
                    <span class="badge bg-primary">{{ order.status }}</span>
                    {% elif order.status == 'В обработке' %}
                    <span class="badge bg-warning">{{ order.status }}</span>
                    {% elif order.status == 'В пути' %}
                    <span class="badge bg-info">{{ order.status }}</span>
                    {% elif order.status == 'Доставлен' %}
                    <span class="badge bg-success">{{ order.status }}</span>
                    {% elif order.status == 'Отменен' %}
                    <span class="badge bg-danger">{{ order.status }}</span>
                    {% else %}
                    <span class="badge bg-secondary">{{ order.status }}</span>
                    {% endif %}
                </td>
                <td>
                    <a href="{{ url_for('user.order_detail', order_id=order.id) }}" 
                       class="btn btn-sm btn-outline-primary">
                        Подробнее
                    </a>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<!-- Пагинация -->
{% if orders.pages > 1 %}
<nav aria-label="Навигация по страницам">
    <ul class="pagination justify-content-center">
        {% if orders.has_prev %}
        <li class="page-item">
            <a class="page-link" href="{{ url_for('user.orders', page=orders.prev_num) }}">Назад</a>
        </li>
        {% endif %}
        
        {% for page_num in orders.iter_pages(left_edge=2, right_edge=2, left_current=2, right_current=2) %}
            {% if page_num %}
                {% if page_num == orders.page %}
                <li class="page-item active">
                    <span class="page-link">{{ page_num }}</span>
                </li>
                {% else %}
                <li class="page-item">
                    <a class="page-link" href="{{ url_for('user.orders', page=page_num) }}">{{ page_num }}</a>
                </li>
                {% endif %}
            {% else %}
                <li class="page-item disabled"><span class="page-link">...</span></li>
            {% endif %}
        {% endfor %}
        
        {% if orders.has_next %}
        <li class="page-item">
            <a class="page-link" href="{{ url_for('user.orders', page=orders.next_num) }}">Вперед</a>
        </li>
        {% endif %}
    </ul>
</nav>
{% endif %}

{% else %}
<div class="text-center py-5">
    <h3>У вас пока нет заказов</h3>
    <p class="text-muted">Сделайте свой первый заказ!</p>
    <a href="{{ url_for('main.index') }}" class="btn btn-primary mt-3">
        Сделать заказ
    </a>
</div>
{% endif %}
{% endblock %}